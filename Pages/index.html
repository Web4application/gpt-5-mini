<!DOCTYPE html>
<html lang="en-US">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<meta name="description" content="ChatGPT5 mini helps you get answers, learn, and be productive." />
<link rel="icon" href="/favicon.png" sizes="32x32" />
<link rel="apple-touch-icon" sizes="180x180" href="/logo.png" />
<link rel="stylesheet" href="/styles/style.css">
<title>ChatGPT5 mini</title>
</head>
<body>

<section class="hero">
  <img src="/logo.png" alt="ChatGPT5 mini logo" />
  <h1>Welcome to ChatGPT5 mini</h1>
  <p>Your AI companion for writing, learning, and productivity.</p>
  <a href="#chat-preview" class="cta-button">Try It Now</a>
</section>

<div style="text-align:center; margin:10px;">
  <button onclick="document.body.classList.toggle('dark-mode')">Toggle Dark Mode</button>
</div>

<section id="chat-preview">
  <h2>See ChatGPT5 mini in Action</h2>
  <div id="chat-container">
    <div id="chat"></div>
    <div id="input-bar">
      <input id="input" type="text" placeholder="Say something‚Ä¶" />
      <button id="send">Send</button>
      <button id="voice" title="Talk to AI">üé§</button>
    </div>
  </div>
</section>

<section class="testimonials">
  <h2>Why People Love ChatGPT5 mini</h2>
  <blockquote>"Helped me write my resume in minutes!" ‚Äì Ada</blockquote>
  <blockquote>"Great for quick brainstorming before meetings." ‚Äì Tunde</blockquote>
</section>

<footer>
  <p>We respect your privacy. No data is stored without your consent.</p>
  <a href="https://github.com/Web4application/roupg" target="_blank">View Source on GitHub</a>
</footer>

<script>
// Chat Elements
const chat = document.getElementById("chat");
const input = document.getElementById("input");
const sendBtn = document.getElementById("send");
const voiceBtn = document.getElementById("voice");

// Send message function
async function sendMessage(){
  const text = input.value.trim();
  if(!text) return;
  addMessage("You: "+text,"user");
  input.value=""; input.focus();

  const typingMsg = addMessage("AI is typing","ai");
  let dots=0;
  const typingInterval = setInterval(()=>{
    dots=(dots+1)%4;
    typingMsg.textContent="AI is typing"+'.'.repeat(dots);
    chat.scrollTop=chat.scrollHeight;
  },500);

  try{
    const res = await fetch("/api/chat",{
      method:"POST",
      headers:{"Content-Type":"application/json"},
      body: JSON.stringify({message:text})
    });
    if(!res.ok) throw new Error("Network response not OK");
    const data = await res.json();
    clearInterval(typingInterval);
    typingMsg.textContent="";
    typeText(typingMsg,"AI: "+data.reply,30);
    speak(data.reply);
  }catch(err){
    clearInterval(typingInterval);
    typingMsg.textContent="‚ö†Ô∏è Error connecting to backend";
    console.error(err);
  }
}

// Typing animation
function typeText(element,text,speed=50){
  let i=0;
  function typing(){
    if(i<text.length){
      element.textContent+=text.charAt(i);
      i++;
      chat.scrollTop=chat.scrollHeight;
      setTimeout(typing,speed);
    }
  }
  typing();
}

// Add messages with avatars
function addMessage(text,cls){
  const container=document.createElement("div");
  container.className=`msg-container ${cls}`;
  const avatar=document.createElement("img");
  avatar.className="msg-avatar";
  avatar.src=cls==="user"?"/user-avatar.png":"/ai-avatar.png";
  const msg=document.createElement("div");
  msg.className="msg";
  msg.textContent=text;
  if(cls==="user"){ container.appendChild(msg); container.appendChild(avatar); }
  else{ container.appendChild(avatar); container.appendChild(msg); }
  chat.appendChild(container);
  chat.scrollTop=chat.scrollHeight;
  return msg;
}

// Voice chat
function speak(text){
  if(!window.speechSynthesis) return;
  const utter=new SpeechSynthesisUtterance(text);
  utter.rate=1; utter.pitch=1;
  window.speechSynthesis.speak(utter);
}

let recognition;
if('webkitSpeechRecognition' in window || 'SpeechRecognition' in window){
  const SpeechRec = window.SpeechRecognition || window.webkitSpeechRecognition;
  recognition=new SpeechRec();
  recognition.continuous=false;
  recognition.lang='en-US';
  recognition.interimResults=false;
  recognition.onresult=function(event){
    input.value=event.results[0][0].transcript;
    sendMessage();
  };
}

voiceBtn.addEventListener("click",()=>{
  if(!recognition){ alert("Speech Recognition not supported in this browser."); return; }
  recognition.start();
});

sendBtn.addEventListener("click",sendMessage);
input.addEventListener("keypress",e=>{ if(e.key==="Enter") sendMessage(); });
  const sendMessage = async () => {
  const text = input.value.trim();
  if (!text) return;

  addMessage('You: ' + text, 'user');
  input.value = '';
  input.focus();

  const typingMsg = addMessage('AI is typing', 'ai');
  let dots = 0;

  const typingInterval = setInterval(() => {
    dots = (dots + 1) % 4;
    typingMsg.textContent = 'AI is typing' + '.'.repeat(dots);
    chat.scrollTop = chat.scrollHeight;
  }, 500);

  try {
    const res = await fetch('/api/chat', {
      method: 'POST',
      headers: { 'Content-Type': 'application/json' },
      body: JSON.stringify({ message: text }),
    });

    if (!res.ok) throw new Error('Network response not OK');
    const data = await res.json();

    clearInterval(typingInterval);
    typingMsg.textContent = '';
    typeText(typingMsg, 'AI: ' + data.reply, 30);
  } catch (err) {
    clearInterval(typingInterval);
    typingMsg.textContent = '‚ö†Ô∏è Error connecting to backend';
    console.error(err);
  }
};
</script>
</body>
</html>
